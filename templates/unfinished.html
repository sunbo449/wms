{% extends 'base.html' %}
{% load static %}
{% load unfinished_tags %}
{% load model_tags %}
{% block css %}
    <link rel="stylesheet" href="{% static 'plugins/bootstrap-modal/css/bootstrap-modal-bs3patch.css' %}">
    <link rel="stylesheet" href="{% static 'plugins/bootstrap-modal/css/bootstrap-modal.css' %}">
    <link rel="stylesheet" href="{% static 'plugins/select2/select2.css' %}">
    <style>
        .explain {
            color: darkred;
        }

        .errors-msg {
            color: red;
            position: absolute;
        }
    </style>
{% endblock %}
{% block non %}"active"{% endblock %}
{% block heading %}在场车辆信息{% endblock %}
{% block main %}
    <!-- start: PAGE CONTENT -->
    <div class="row">
        <div class="col-md-12">
            <!-- start: CONTEXTUAL CLASSES -->
            <div class="panel panel-white">
                <div class="panel-heading">
                    <h4 class="panel-title">在场车辆结构数据 <i class="fa fa-th-list"></i></h4>
                    <div class="panel-tools">
                        <div class="dropdown">
                            <a data-toggle="dropdown" class="btn btn-xs dropdown-toggle btn-transparent-grey">
                                <i class="fa fa-cog"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-light pull-right" role="menu">
                                <li>
                                    <a class="panel-refresh" href="#"> <i class="fa fa-refresh"></i>
                                        <span>刷 新 数 据</span> </a>
                                </li>
                                <li>
                                    <a class="panel-expand" href="#"> <i class="fa fa-expand"></i>
                                        <span>全 屏 查 看</span></a>
                                </li>
                            </ul>
                        </div>
                        <a class="btn btn-xs btn-link panel-close" href="#"> <i class="fa fa-times"></i> </a>
                    </div>
                </div>
                <div class="panel-body">
                    <table class="table table-bordered" id="sample-table-1">
                        <tbody>
                        {% service_team as msg_lis %}
                        <tr class="info">
                            {% for msg_title in msg_lis %}
                                <td class="center">{{ msg_title.caption }}</td>
                            {% endfor %}
                        </tr>
                        <tr>
                            <td class="center">5</td>
                            <td class="center">6</td>
                            <td class="center">5</td>
                            <td class="center">6</td>
                            <td class="center">5</td>
                            <td class="center">5</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="panel-body">
                    <table class="table table-bordered" id="sample-table-1">
                        <tbody>
                        <tr class="info">
                            <td class="center">机修在场</td>
                            <td class="center">事故在场(有机修项目)</td>
                            <td class="center">等待备件</td>
                            <td class="center">等待通知</td>
                            <td class="center">其他原因</td>
                        </tr>
                        <tr>
                            <td class="center">1</td>
                            <td class="center">2</td>
                            <td class="center">3</td>
                            <td class="center">4</td>
                            <td class="center">5</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- end: CONTEXTUAL CLASSES -->
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <!-- start: BASIC TABLE PANEL -->
            <div class="panel panel-white">
                <div class="panel-heading">
                    <h4 class="panel-title">在场车辆信息看板 <i class="fa fa-table"></i>
                    </h4>
                    <div class="panel-tools">
                        <div class="dropdown">
                            <a data-toggle="dropdown" class="btn btn-xs dropdown-toggle btn-transparent-grey">
                                <i class="fa fa-cog"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-light pull-right" role="menu">
                                <li>
                                    <a class="panel-refresh" href="#"> <i class="fa fa-refresh"></i>
                                        <span>刷 新 窗 口</span> </a>
                                </li>
                                <li>
                                    <a class="panel-expand" href="#"> <i class="fa fa-expand"></i>
                                        <span>全 屏 查 看</span></a>
                                </li>
                            </ul>
                        </div>
                        <a class="btn btn-xs btn-link panel-close" href="#"> <i class="fa fa-times"></i> </a>
                    </div>
                </div>
                <div class="panel-body">
                    {#                    <table id="example" class="display" style="width:100%">#}
                    {#                        <thead>#}
                    {#                        <tr class="info">#}
                    {#                            <th class="center">车牌号码</th>#}
                    {#                            <th class="center">工单号</th>#}
                    {#                            <th class="center">服务顾问</th>#}
                    {#                            <th class="center">快修班组</th>#}
                    {#                            <th class="center">机电班组</th>#}
                    {#                            <th class="hidden-xs center">维修内容</th>#}
                    {#                            <th class="hidden-xs center">当前状态</th>#}
                    {#                            <th class="hidden-xs center">预计交付日期</th>#}
                    {#                            <th class="hidden-xs center">预计交付时间</th>#}
                    {#                            <th class="hidden-xs center">实际交车日期</th>#}
                    {#                            <th class="hidden-xs center">实际交车时间</th>#}
                    {#                            {% if request.team == "管理员组" %}#}
                    {#                                <th class="hidden-xs center">修改</th>#}
                    {#                            {% endif %}#}
                    {#                        </tr>#}
                    {#                        </thead>#}
                    {#                        <tbody>#}
                    {#                        {% unfinished_messages as msg_list %}#}
                    {#                        {% for msg in msg_list %}#}
                    {#                            <tr class="success" data-toggle="modal" href="#responsive">#}
                    {#                                <td class="vehicle-num center">{{ msg.vehicle_num }}</td>#}
                    {#                                <td class="center">{{ msg.wip }}</td>#}
                    {#                                <td class="center">{{ msg.sa }}</td>#}
                    {#                                <td class="center">{{ msg.quick_service_team }}</td>#}
                    {#                                <td class="center">{{ msg.service_team }}</td>#}
                    {#                                <td class="hidden-xs center">{{ msg.service_project }}</td>#}
                    {#                                <td class="hidden-xs center">{{ msg.service_status }}</td>#}
                    {#                                <td class="hidden-xs center">{{ msg.estimate_finish_date }}</td>#}
                    {#                                <td class="hidden-xs center">{{ msg.estimate_finish_time }}</td>#}
                    {#                                <td class="hidden-xs center">{{ msg.actual_finish_date }}</td>#}
                    {#                                <td class="hidden-xs center">{{ msg.actual_finish_time }}</td>#}
                    {#                                <td class="visible-md visible-lg hidden-sm hidden-xs center">#}
                    {#                                    <a href="#responsive" class="btn btn-xs btn-blue tooltips btn-vehicle-info"#}
                    {#                                       data-placement="top" id="{{ msg.id }}"#}
                    {#                                       data-original-title="修改" data-toggle="modal"><i class="fa fa-edit"></i></a>#}
                    {#                                </td>#}
                    {#                            </tr>#}
                    {#                        {% endfor %}#}
                    {#                        </tbody>#}
                    {#                    </table>#}
                    <table class="table table-striped table-bordered table-hover table-full-width" id="sample_1">
                        <thead>
                        <tr class="info">
                            <th style="display: none">ID</th>
                            <th class="center">车牌号码</th>
                            <th class="center">工单号</th>
                            <th class="center">服务顾问</th>
                            <th class="center">快修班组</th>
                            <th class="center">机电班组</th>
                            <th class="hidden-xs center">维修内容</th>
                            <th class="hidden-xs center">当前状态</th>
                            <th class="hidden-xs center">预计交付日期</th>
                            <th class="hidden-xs center">预计交付时间</th>
                            <th class="hidden-xs center">实际交车日期</th>
                            <th class="hidden-xs center">实际交车时间</th>
                            {#                            {% if request.team == "管理员组" %}#}
                            {#                                <th class="hidden-xs center">修改</th>#}
                            {#                            {% endif %}#}
                        </tr>
                        </thead>
                        <tbody id="sample_body">
                        {% unfinished_messages as msg_list %}
                        {% for msg in msg_list %}
                            <tr class="success" id="{{ msg.id }}" href="#responsive" data-toggle="modal">
                                <td style="display: none">{{ msg.id }}</td>
                                <td class="veh_num center">{{ msg.vehicle_num }}</td>
                                <td class="veh_wip center">{{ msg.wip }}</td>
                                <td class="veh_sa center">{{ msg.sa }}</td>
                                <td class="veh_quick_service_team center">{{ msg.quick_service_team }}</td>
                                <td class="veh_service_team center">{{ msg.service_team }}</td>
                                <td class="veh_service_project hidden-xs center">{{ msg.service_project }}</td>
                                <td class="veh_service_status hidden-xs center">{{ msg.service_status }}</td>
                                <td class="hidden-xs center">{{ msg.estimate_finish_date|date:"Y-m-d" }}</td>
                                <td class="hidden-xs center">{{ msg.estimate_finish_time }}</td>
                                <td class="veh_actual_finish_date hidden-xs center">{{ msg.actual_finish_date|date:"Y-m-d" }}</td>
                                <td class="veh_actual_finish_time hidden-xs center">{{ msg.actual_finish_time }}</td>
                                {#                                <td class="visible-md visible-lg hidden-sm hidden-xs center">#}
                                {#                                    <a href="#responsive" class="btn btn-xs btn-blue tooltips btn-vehicle-info"#}
                                {#                                       data-placement="top" id="{{ msg.id }}"#}
                                {#                                       data-original-title="修改" data-toggle="modal"><i class="fa fa-edit"></i></a>#}
                                {#                                </td>#}
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- end: BASIC TABLE PANEL -->
        </div>
    </div>
{% endblock %}
{% block other %}
    <div id="responsive" class="modal extended-modal fade no-display" tabindex="-1" data-width="760">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title explain"></h4>
                </div>
                <form id="vehicle_message_edit">
                    {% csrf_token %}
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label" for="edit-veh-number">
                                        车 牌 号 码 <span class="symbol required"></span>
                                    </label>
                                    <input type="text" class="form-control" id="edit-veh-number" name="veh_number">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label" for="edit-wip">
                                        工 单 号 码 <span class="symbol required"></span>
                                    </label>
                                    <input type="text" class="form-control" id="edit-wip" name="edit_wip">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label" for="veh-sa">
                                        服 务 顾 问 <span class="symbol required"></span>
                                    </label>
                                    <input type="text" class="form-control" id="veh-sa" name="veh_sa">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label" for="veh-service-status">
                                        维 修 状 态 <span class="symbol required"></span>
                                    </label>
                                    <input type="text" class="form-control" id="veh-service-status"
                                           name="veh_service_status">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label" for="veh-quick-team">
                                        快 修 班 组 <span class="symbol required"></span>
                                    </label>
                                    <select class="form-control" name="veh_quick_service_team" id="veh-quick-team">
                                        {% quick_service_team as team_list %}
                                        {% for team in team_list %}
                                            <option value={{ team.caption }}>{{ team.caption }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label" for="veh-service-team">
                                        机 电 班 组<span class="symbol required"></span>
                                    </label>
                                    <select class="form-control" name="veh_service_team" id="veh-service-team">
                                        {% service_team as service_team_list %}
                                        {% for team in service_team_list %}
                                            <option value={{ team.caption }}>{{ team.caption }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label" for="veh-actual-finish-date">
                                        实际交车日期<span class="symbol required"></span>
                                    </label>
                                    <input type="date" class="form-control" id="veh-actual-finish-date"
                                           name="veh_actual_finish_date">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label" for="veh-actual-finish-time">
                                        实际交车时间<span class="symbol required"></span>
                                    </label>
                                    <input type="time" class="form-control" id="veh-actual-finish-time"
                                           name="veh_actual_finish_time">
                                </div>
                            </div>
                            <div class="col-md-12">
                                <p class="explain"> 说明1：如需修改工单号，需将工单号信息全部删除后，填写实际工单号即可；</p>
                                <p class="explain"> 说明2：维修状态建议：只需将 暂停等件 更改为 正常维修，其他状态无需更改！可能会出现意外！</p>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <p class="errors-msg">错误信息</p>
                        <button type="button" data-dismiss="modal" class="btn btn-light-grey">
                            关 闭
                        </button>
                        <button type="button" class="btn btn-blue btn-submit">
                            保存信息
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock %}
{% block js %}
    <script src="{% static 'plugins/select2/select2.min.js' %}"></script>
    <script src="{% static 'js/table-data.js' %}"></script>
    <script>
        jQuery(document).ready(function () {
            Main.init();
            {#SVExamples.init();#}
            TableData.init();

            $('.btn-submit').on('click', function () {
                $.ajax({
                    url: "{% url 'business:vehicle_info_edit' %}",
                    type: "POST",
                    data: $('#vehicle_message_edit').serialize(),
                    success: function (res) {
                        console.log(123)
                    }
                })
            })
        })
    </script>
{% endblock %}
